<!-- Audio Player Component -->
<div class="bg-white rounded-lg shadow p-6" x-data="audioPlayer()">
    <div class="flex items-center justify-between mb-4">
        <div>
            <h3 class="font-semibold text-lg">{{ audio.filename }}</h3>
            <p class="text-sm text-gray-600">{{ audio.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
        </div>
        <span class="px-3 py-1 text-sm font-semibold rounded {% if audio.status == 'completed' %}bg-green-100 text-green-800{% elif audio.status == 'processing' %}bg-blue-100 text-blue-800{% else %}bg-yellow-100 text-yellow-800{% endif %}">
            {{ audio.status }}
        </span>
    </div>
    
    {% if audio.status == 'processing' %}
    <div class="mb-4">
        <div class="flex justify-between text-sm text-gray-600 mb-1">
            <span>Processing...</span>
            <span>{{ audio.progress }}%</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
            <div class="bg-purple-600 h-2 rounded-full transition-all duration-300" style="width: {{ audio.progress }}%"></div>
        </div>
    </div>
    {% endif %}
    
    {% if audio.status == 'completed' %}
    <div class="mb-4">
        <audio controls class="w-full" x-ref="audioElement">
            <source src="{{ url_for('static', path='audio/' + audio.file_path.split('/')[-1]) }}" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
    </div>
    
    <div class="grid grid-cols-3 gap-4 text-sm mb-4">
        <div>
            <p class="text-gray-600">Duration</p>
            <p class="font-semibold">{{ '%d:%02d' % (audio.duration // 60, audio.duration % 60) }}</p>
        </div>
        <div>
            <p class="text-gray-600">Size</p>
            <p class="font-semibold">{{ (audio.file_size / 1024 / 1024)|round(2) }} MB</p>
        </div>
        <div>
            <p class="text-gray-600">Downloads</p>
            <p class="font-semibold">{{ audio.download_count }}</p>
        </div>
    </div>
    {% endif %}
    
    <div class="flex space-x-2">
        {% if audio.status == 'completed' %}
        <a href="{{ url_for('download_audio', audio_id=audio.id) }}" class="flex-1 bg-green-600 hover:bg-green-700 text-white text-center px-4 py-2 rounded text-sm">
            Download
        </a>
        {% endif %}
        <button @click="deleteAudio({{ audio.id }})" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded text-sm">
            Delete
        </button>
    </div>
</div>

<script>
function audioPlayer() {
    return {
        deleteAudio(audioId) {
            if (confirm('Are you sure you want to delete this audio file?')) {
                // Delete audio logic
                fetch(`${API_BASE}/audio/${audioId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`
                    }
                }).then(response => {
                    if (response.ok) {
                        showToast('Audio deleted successfully', 'success');
                        window.location.reload();
                    }
                });
            }
        }
    }
}
</script>